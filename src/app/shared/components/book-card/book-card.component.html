<!-- =========================================================
     Book Card Component Template
     - Displays book information such as title, image, description
     - Shows status, reservation and loan details
     - Provides navigation link and management actions
     - Includes conditional rendering for compact mode
   ========================================================= -->

<div class="book-card" [class.is-compact]="compact">
  <!-- ========================
       Header: Book Title
       ======================== -->
  <div class="book-card__header">
    <h3 class="book-card__title">{{ title }}</h3>
  </div>

  <!-- ========================
       Book Image
       - Hidden if compact mode is enabled
       - Displays placeholder if no image is provided
       ======================== -->
  <div class="book-card__image" *ngIf="!compact">
    <ng-container *ngIf="image; else placeholder">
      <img ngSrc="{{ image }}" [alt]="title" width="400" height="300" loading="lazy" />
    </ng-container>
    <!-- Placeholder shown when no image is available -->
    <ng-template #placeholder>
      <img ngSrc="assets/images/placeholder.webp" [alt]="title" width="1200" height="800" loading="lazy" />
    </ng-template>
  </div>

  <!-- ========================
       Content Section
       Contains description, status, dates, actions and links
       ======================== -->
  <div class="book-card__content">
    <!-- Book description (hidden if empty or only whitespace) -->
    <p *ngIf="description?.trim()" class="book-card__description">{{ description }}</p>

    <!-- Book status (displayed only if showStatus is true) -->
    <span *ngIf="showStatus" class="book-card__status">État : {{ status }}</span>

    <!-- Reservation details (shown if at least one date is provided) -->
    <div *ngIf="reservationDate || expirationDate" class="book-card__reservation">
      <p *ngIf="reservationDate">Date de réservation : {{ reservationDate }}</p>
      <p *ngIf="expirationDate">Expiration : {{ expirationDate }}</p>
    </div>

    <!-- Loan details (shown if at least one date is provided) -->
    <div *ngIf="loanDate || returnDate" class="book-card__loan">
      <p *ngIf="loanDate">Date d’emprunt : {{ loanDate }}</p>
      <p *ngIf="returnDate">Date de retour : {{ returnDate }}</p>
    </div>

    <!-- Navigation link to book details
         - Uses routerLink if command is available
         - Falls back to disabled span otherwise -->
    <a
      class="book-card__link"
      *ngIf="routerLinkCmd as cmd; else disabledLink"
      [routerLink]="cmd"
      [attr.aria-label]="'Voir le détail de ' + title">
      Voir le détail
    </a>
    <ng-template #disabledLink>
      <span class="book-card__link is-disabled" aria-disabled="true" title="Identifiant manquant">
        Voir le détail
      </span>
    </ng-template>

    <!-- ========================
         Catalog Management Actions
         - Displayed only if [manage]="true"
         - Provides edit and delete buttons
         ======================== -->
    <div class="book-card__manage" *ngIf="manage">
      <button type="button" class="styled-button secondary" (click)="onEditClick()">
        Modifier
      </button>
      <button type="button" class="styled-button danger" (click)="onDeleteClick()">
        Supprimer
      </button>
    </div>

    <!-- ========================
         Reservation / Loan Actions
         - Cancel button shown if cancellable
         - Extend button shown if extendable
         ======================== -->
    <button *ngIf="cancellable" type="button" class="styled-button" (click)="onCancelClick()">
      {{ cancelLabel }}
    </button>
    <button *ngIf="extendable" type="button" class="styled-button" (click)="onExtendClick()">
      {{ extendLabel }}
    </button>
  </div>
</div>



